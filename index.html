<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Game Companion</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Your ultimate gaming toolkit for board games, card games, and dice games">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Game Companion">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Karla:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #FF6B35;
            --secondary: #004E89;
            --accent: #F7B801;
            --dark: #1A1A2E;
            --light: #F8F9FA;
            --card-bg: #FFFFFF;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Karla', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 1rem;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 53, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(247, 184, 1, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-family: 'Righteous', cursive;
            font-size: 3.5rem;
            color: white;
            text-shadow: 4px 4px 0px rgba(0, 0, 0, 0.2);
            margin-bottom: 0.5rem;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 400;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px var(--shadow);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            animation: fadeIn 0.8s ease-out 0.2s both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 50px;
            background: var(--light);
            color: var(--dark);
            font-family: 'Karla', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            transform: scale(1.05);
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 0.75rem 1.5rem;
            border: 2px solid var(--light);
            border-radius: 50px;
            font-size: 1rem;
            font-family: 'Karla', sans-serif;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .add-game-btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            font-family: 'Karla', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .add-game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            animation: fadeIn 1s ease-out 0.4s both;
        }

        .game-card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 8px 32px var(--shadow);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .game-card:hover::before {
            transform: scaleX(1);
        }

        .game-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.15);
        }

        .game-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .game-card:hover .game-icon {
            transform: rotate(5deg) scale(1.1);
        }

        .game-title {
            font-family: 'Righteous', cursive;
            font-size: 1.5rem;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .game-actions {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            min-width: 80px;
            padding: 0.6rem;
            border: none;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Karla', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), #0077b6);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 78, 137, 0.3);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 2px solid var(--secondary);
        }

        .btn-secondary:hover {
            background: var(--secondary);
            color: white;
        }

        .game-features {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .feature-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            background: rgba(102, 126, 234, 0.1);
            color: var(--secondary);
        }

        .collection-btns {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .collection-btn {
            padding: 0.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            border-radius: 50%;
        }

        .collection-btn:hover {
            transform: scale(1.2);
        }

        .collection-btn.active {
            background: rgba(255, 107, 53, 0.1);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 2rem;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalSlideUp 0.4s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--light);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--primary);
            color: white;
            transform: rotate(90deg);
        }

        .modal-title {
            font-family: 'Righteous', cursive;
            font-size: 2rem;
            color: var(--dark);
            margin-bottom: 1.5rem;
        }

        .scorecard {
            background: var(--light);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .scorecard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .scorecard-actions {
            display: flex;
            gap: 0.5rem;
        }

        .score-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Karla', sans-serif;
        }

        .player-input {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .score-input {
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Karla', sans-serif;
            transition: all 0.3s ease;
        }

        .score-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .timer-display {
            font-family: 'Righteous', cursive;
            font-size: 3rem;
            text-align: center;
            color: var(--secondary);
            margin: 1rem 0;
        }

        .timer-controls {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .calculator {
            background: var(--light);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .calc-display {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: right;
            font-size: 2rem;
            font-family: 'Righteous', cursive;
            margin-bottom: 1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }

        .calc-btn {
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-family: 'Karla', sans-serif;
        }

        .calc-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        .calc-btn.operator {
            background: var(--secondary);
            color: white;
        }

        .calc-btn.equals {
            background: var(--primary);
            color: white;
            grid-column: span 2;
        }

        .add-player-btn {
            width: 100%;
            padding: 0.75rem;
            border: 2px dashed var(--secondary);
            background: transparent;
            border-radius: 8px;
            color: var(--secondary);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0.5rem;
        }

        .add-player-btn:hover {
            background: rgba(0, 78, 137, 0.1);
            transform: scale(1.02);
        }

        .yahtzee-scorecard {
            display: grid;
            gap: 0.5rem;
        }

        .yahtzee-section {
            background: white;
            padding: 1rem;
            border-radius: 8px;
        }

        .yahtzee-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 0.5rem;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .yahtzee-row.clue-row {
            grid-template-columns: 2fr 1fr;
        }

        .yahtzee-row:last-child {
            border-bottom: none;
        }

        .yahtzee-label {
            font-weight: 700;
            color: var(--dark);
        }

        .section-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }

        .total-row {
            background: rgba(102, 126, 234, 0.1);
            font-weight: 700;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .games-grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .filter-btn {
                width: 100%;
            }
        }

        .hidden {
            display: none !important;
        }

        .new-game-form {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: 700;
            color: var(--dark);
        }

        .form-input {
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Karla', sans-serif;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé≤ Complete Game Companion üÉè</h1>
            <p class="subtitle">Your ultimate gaming toolkit for every occasion</p>
        </header>

        <div class="controls">
            <button class="filter-btn active" data-filter="all">All Games</button>
            <button class="filter-btn" data-filter="favorites">‚≠ê Favorites</button>
            <button class="filter-btn" data-filter="collection">üìö My Collection</button>
            <input type="text" class="search-box" placeholder="Search games..." id="searchBox">
            <button class="add-game-btn" onclick="openAddGameModal()">+ Add Game</button>
        </div>

        <div class="games-grid" id="gamesGrid"></div>
    </div>

    <!-- Game Modal -->
    <div class="modal" id="gameModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Add Game Modal -->
    <div class="modal" id="addGameModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAddGameModal()">√ó</button>
            <h2 class="modal-title">Add New Game</h2>
            <form class="new-game-form" onsubmit="addNewGame(event)">
                <div class="form-group">
                    <label>Game Name *</label>
                    <input type="text" class="form-input" id="newGameName" required>
                </div>
                <div class="form-group">
                    <label>Game Icon (emoji)</label>
                    <input type="text" class="form-input" id="newGameIcon" placeholder="üéÆ">
                </div>
                <div class="form-group">
                    <label>Icon Background Color</label>
                    <input type="color" class="form-input" id="newGameColor" value="#667eea">
                </div>
                <div class="form-group">
                    <label>Features</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="needsScorecard">
                            Scorecard
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="needsTimer">
                            Timer
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="needsCalculator">
                            Calculator
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Timer Default (minutes)</label>
                    <input type="number" class="form-input" id="timerDefault" value="3" min="1">
                </div>
                <button type="submit" class="action-btn btn-primary" style="width: 100%; padding: 1rem;">Add Game</button>
            </form>
        </div>
    </div>

    <script>
        // Game database with all information
        const games = [
            {
                name: "Blockbuster",
                icon: "üé¨",
                color: "#e63946",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.boardgamehalv.com/blockbuster/",
                downloadInstructions: "https://www.boardgamehalv.com/blockbuster/",
                rules: "Divide into two teams. One player from each team competes head-to-head. Draw a category card and set the timer. Teams take turns naming movies that fit the category. First team to collect 6 category cards wins the game."
            },
            {
                name: "Clue",
                icon: "üîç",
                color: "#2a9d8f",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/clue",
                downloadInstructions: "https://www.hasbro.com/common/instruct/Clue_(2002).pdf",
                specialScorecard: "clue",
                rules: "Solve the murder mystery by determining WHO killed Mr. Boddy, WHERE, and with WHAT weapon. Roll dice to move around the mansion. Make suggestions to gather clues. Use deduction to eliminate suspects, weapons, and rooms. First to make a correct accusation wins!"
            },
            {
                name: "Codenames",
                icon: "üïµÔ∏è",
                color: "#f4a261",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://czechgames.com/files/rules/codenames-rules-en.pdf",
                downloadInstructions: "https://czechgames.com/files/rules/codenames-rules-en.pdf",
                rules: "Two teams compete. Each team has a Spymaster who gives one-word clues to help teammates identify their agents (words) on the board. Avoid the assassin! The Spymaster says a word and a number (how many words relate to the clue). First team to find all their agents wins!"
            },
            {
                name: "Cribbage",
                icon: "üÉè",
                color: "#6a4c93",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/cribbage",
                downloadInstructions: "https://www.officialgamerules.org/cribbage",
                rules: "A 2-player card game using a standard deck. Deal 6 cards each, discard 2 to the 'crib'. Play cards to try to make 15 or 31. Score points for pairs, runs, and combinations. Use the cribbage board to track points. First to 121 points wins!"
            },
            {
                name: "Dominoes",
                icon: "üÄÑ",
                color: "#2d3748",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/dominoes",
                downloadInstructions: "https://www.officialgamerules.org/dominoes",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/double-six-dominoes/",
                rules: "Draw 7 dominoes each. First player places any domino. Take turns matching numbers on the ends of the domino chain. If you can't play, draw from the boneyard. First to play all dominoes wins the round. Score points based on opponent's remaining tiles."
            },
            {
                name: "Doomlings",
                icon: "üíÄ",
                color: "#d62828",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.doomlings.com/pages/how-to-play",
                downloadInstructions: "https://www.doomlings.com/pages/how-to-play",
                rules: "Collect adorable creatures before the world ends! Draw and play Doomlings (creatures) with different traits. Use actions to help yourself or hinder opponents. Age cards advance the world toward doom. When Doomsday arrives, player with most points wins!"
            },
            {
                name: "Dumb Ways to Die",
                icon: "‚ò†Ô∏è",
                color: "#e76f51",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://boardgamegeek.com/boardgame/234075/dumb-ways-die",
                downloadInstructions: "https://boardgamegeek.com/filepage/169336/dumb-ways-die-rules",
                rules: "Draw cards depicting dangerous situations. Flip a risk card to determine how many challenge cards to complete. Perform silly challenges before the timer runs out. Complete challenges to stay alive. Last player standing wins!"
            },
            {
                name: "Exploding Kittens",
                icon: "üí£",
                color: "#f77f00",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.explodingkittens.com/pages/how-to-play",
                downloadInstructions: "https://www.explodingkittens.com/pages/how-to-play",
                rules: "Draw cards until someone draws an Exploding Kitten and loses (unless they have a Defuse card). Use action cards to avoid, move, or force others to draw. Skip, Attack, See the Future, Shuffle, and more. Last player alive wins!"
            },
            {
                name: "Go Fish",
                icon: "üê†",
                color: "#00b4d8",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/go-fish",
                downloadInstructions: "https://www.pagat.com/fishing/gofish.html",
                rules: "Deal 5-7 cards to each player. Take turns asking opponents for specific cards to make sets of four. If they don't have it, 'Go Fish' and draw from the deck. When you make a set of 4, lay it down. Player with the most sets wins!"
            },
            {
                name: "Hand and Foot",
                icon: "‚úã",
                color: "#e76f51",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.pagat.com/rummy/handfoot.html",
                downloadInstructions: "https://www.pagat.com/rummy/handfoot.html",
                rules: "A Canasta variant with 5 decks. Each player gets a Hand and a Foot (two sets of cards). Play the Hand first, then the Foot. Make melds of 3+ cards. Need specific melds to go out. Red 3s are bonuses, black 3s block the discard pile. First team to reach 10,000 points wins!"
            },
            {
                name: "Hearts",
                icon: "‚ù§Ô∏è",
                color: "#e63946",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/hearts",
                downloadInstructions: "https://www.pagat.com/reverse/hearts.html",
                rules: "Avoid taking hearts (1 point each) and the Queen of Spades (13 points). Deal all cards evenly. Play tricks - follow suit if possible. Highest card of the led suit takes the trick. You can't lead hearts until hearts are 'broken'. Lowest score after reaching 100 points wins! Or 'shoot the moon' by taking all hearts and the Queen to give opponents 26 points each."
            },
            {
                name: "Life",
                icon: "üé°",
                color: "#06a77d",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/the-game-of-life",
                downloadInstructions: "https://www.hasbro.com/common/instruct/gameoflife.pdf",
                rules: "Navigate life from college to retirement! Spin the wheel and move your car. Make choices about career, family, and investments. Collect Life Tiles and money. Pay bills and taxes. The path forks - choose wisely! Retire at Millionaire Estates or Countryside Acres. Count your wealth - richest player wins!"
            },
            {
                name: "Monopoly",
                icon: "üé©",
                color: "#2a9d8f",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/monopoly",
                downloadInstructions: "https://www.hasbro.com/common/instruct/monins.pdf",
                rules: "Buy properties and charge rent! Roll dice to move around the board. Buy properties you land on. Build houses and hotels to increase rent. Pay rent when landing on opponent's properties. Go to Jail. Pass GO to collect $200. Trade with other players. Last player with money wins!"
            },
            {
                name: "Pass the Bomb",
                icon: "üí£",
                color: "#d62828",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: false,
                timerDefault: 1,
                instructions: "https://www.ultraboardgames.com/pass-the-bomb/game-rules.php",
                downloadInstructions: "https://www.ultraboardgames.com/pass-the-bomb/game-rules.php",
                rules: "Draw a card showing letter combinations. Start the bomb timer (randomized). Name a word containing those letters and pass the bomb to the next player. Keep going until the bomb explodes! The player holding the bomb takes the card. First to 13 cards loses!"
            },
            {
                name: "Pass the Pig",
                icon: "üê∑",
                color: "#ffb5a7",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/pass-the-pigs",
                downloadInstructions: "https://winning-moves.com/images/gamerulesPDFs/PassThePigs.pdf",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/pass-the-pigs/",
                rules: "Roll two pig dice! Each position scores points: Sider (1), Trotter (5), Razorback (5), Snouter (10), Leaning Jowler (15). Matching positions score double. Keep rolling to accumulate points or pass. But if you roll Pig Out (different sides), you lose all points for that turn! First to 100 wins!"
            },
            {
                name: "Phase 10",
                icon: "üîü",
                color: "#8338ec",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/phase-10",
                downloadInstructions: "https://service.mattel.com/instruction_sheets/42003pr.pdf",
                specialScorecard: "phase10",
                rules: "Complete 10 phases in order: sets, runs, cards of one color, etc. Draw and discard cards. Lay down your phase when complete, then add cards to any phase. First to go out scores 0, others score their remaining cards. Complete all 10 phases first to win!"
            },
            {
                name: "Poker",
                icon: "üé∞",
                color: "#2d3748",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/poker",
                downloadInstructions: "https://www.pagat.com/poker/",
                rules: "Make the best 5-card hand. Bet on your hand's strength. Players can Call (match bet), Raise (increase bet), or Fold (quit hand). After betting rounds, remaining players show hands. Best hand wins the pot! Hands ranked: Royal Flush, Straight Flush, Four of a Kind, Full House, Flush, Straight, Three of a Kind, Two Pair, Pair, High Card."
            },
            {
                name: "Risk",
                icon: "üåç",
                color: "#d62828",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/risk",
                downloadInstructions: "https://www.hasbro.com/common/instruct/risk.pdf",
                rules: "Conquer the world! Place armies on territories you control. On your turn: get reinforcements, attack adjacent enemy territories (roll dice to battle), and fortify positions. Attacker rolls up to 3 dice, defender up to 2. Highest rolls win. Complete your secret mission or eliminate all opponents to win!"
            },
            {
                name: "Rummikub",
                icon: "üé≤",
                color: "#fb8500",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: true,
                timerDefault: 4,
                instructions: "https://www.officialgamerules.org/rummikub",
                downloadInstructions: "https://rummikub.com/wp-content/uploads/2019/12/2600-English.pdf",
                rules: "Make runs (consecutive numbers in same color) or groups (same number in different colors) using tiles. Draw 14 tiles. First meld must be worth 30+ points. Manipulate existing sets on the table. Jokers are wild. Draw a tile if you can't play. First to use all tiles wins! Others score their remaining tiles as negative points."
            },
            {
                name: "Rummy",
                icon: "üÉè",
                color: "#e76f51",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/rummy",
                downloadInstructions: "https://www.pagat.com/rummy/rummy.html",
                rules: "Form sets (3-4 of same rank) or runs (3+ consecutive cards of same suit). Deal 7-10 cards each. Draw from deck or discard pile. Lay down melds when you have them. Discard one card to end your turn. 'Go out' by using all cards. Score points based on cards left in opponent's hands."
            },
            {
                name: "Scattergories",
                icon: "üìù",
                color: "#06a77d",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/scattergories",
                downloadInstructions: "https://www.hasbro.com/common/instruct/Scattergories.pdf",
                specialScorecard: "scattergories",
                rules: "Roll the letter die. Set the timer for 3 minutes. Think of words starting with that letter for each category (like 'Things in a Kitchen'). Write your answers. When time's up, compare answers. Score 1 point for each unique answer that no one else wrote. Most points wins!"
            },
            {
                name: "Scrabble",
                icon: "üî§",
                color: "#2a9d8f",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/scrabble",
                downloadInstructions: "https://scrabble.hasbro.com/en-us/rules",
                rules: "Form words on the board using letter tiles. Each letter has a point value. Draw 7 tiles. Place words horizontally or vertically, connecting to existing words. Use premium squares (Double/Triple Letter/Word) to multiply scores. First player to use all tiles gets a 50-point bonus. Highest score wins!"
            },
            {
                name: "Sequence",
                icon: "üé¥",
                color: "#8338ec",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/sequence",
                downloadInstructions: "https://www.jaxgames.com/wp-content/uploads/2021/07/Sequence-Instructions.pdf",
                rules: "Play a card and place your chip on the matching space on the board. Get 5 chips in a row (horizontally, vertically, or diagonally) to make a Sequence. Two-eyed Jacks are wild. One-eyed Jacks remove opponent chips. First team/player to make 2 Sequences wins! (Or 1 for 2 players)"
            },
            {
                name: "Slapzi",
                icon: "üëã",
                color: "#f77f00",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.tenzi.com/slapzi",
                downloadInstructions: "https://www.tenzi.com/slapzi",
                rules: "Fast-paced picture card game! Flip a clue card (like 'Something Hot'). Everyone races to slap a picture card that matches from their hand. First to slap a valid match keeps the clue card. Draw back up to 5 picture cards. First to collect 10 clue cards wins!"
            },
            {
                name: "Sorry",
                icon: "üòÖ",
                color: "#e63946",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/sorry",
                downloadInstructions: "https://www.hasbro.com/common/instruct/sorry.pdf",
                rules: "Race your 4 pawns from Start to Home! Draw cards to move. Special cards: Sorry! (send opponent back to start), Switch (swap places), and more. You must draw a 1 or 2 to leave Start. Land on opponent's pawn to send it back to Start and say 'Sorry!' First to get all 4 pawns Home wins!"
            },
            {
                name: "Spades",
                icon: "‚ô†Ô∏è",
                color: "#2d3748",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/spades",
                downloadInstructions: "https://www.pagat.com/auctionwhist/spades.html",
                rules: "Played in partnerships. Bid how many tricks you think you'll win (based on your 13 cards). Spades are always trump. Play tricks - follow suit or trump with spades. Make your bid to score points; fail and lose points. 'Bags' (extra tricks) give bonus points but 10 bags = -100 points. First team to 500 wins!"
            },
            {
                name: "Tenzi",
                icon: "üé≤",
                color: "#06a77d",
                hasScorecard: true,
                hasTimer: true,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.tenzi.com/how-to-play",
                downloadInstructions: "https://www.tenzi.com/how-to-play",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/tenzi-dice-game/",
                rules: "Everyone gets 10 dice. Someone says 'GO!' Everyone rolls. Pick a number and keep re-rolling to get all 10 dice showing that number. Set aside matching dice and keep rolling the rest. First to get all 10 matching shouts 'TENZI!' and wins! Play with variations for extra challenge."
            },
            {
                name: "Texas Hold'em",
                icon: "ü§†",
                color: "#8b4513",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/texas-holdem",
                downloadInstructions: "https://www.pagat.com/poker/variants/texasholdem.html",
                rules: "Each player gets 2 hole cards (face down). Betting round. Then 3 community cards (the Flop). Bet. Then 1 card (the Turn). Bet. Then 1 card (the River). Final betting. Make best 5-card hand using any combo of your 2 cards + 5 community cards. Best hand wins the pot!"
            },
            {
                name: "Ticket To Ride",
                icon: "üöÇ",
                color: "#d62828",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.daysofwonder.com/tickettoride/en/usa/",
                downloadInstructions: "https://ncdn0.daysofwonder.com/tickettoride/en/img/tt_rules_2015_en.pdf",
                rules: "Build train routes across the map! Draw destination tickets showing city pairs. Collect colored train cards. Play matching cards to claim routes between cities. Longer routes score more points. Complete your destination tickets for bonus points. Longest continuous route earns extra points. Most points wins!"
            },
            {
                name: "Trouble",
                icon: "üé≤",
                color: "#fb8500",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/trouble",
                downloadInstructions: "https://www.hasbro.com/common/instruct/trouble.pdf",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/trouble/",
                rules: "Press the Pop-O-Matic bubble to roll the die! Move your pegs around the board. Roll a 6 to get a peg out of Home. Land on opponent's peg to send it back Home. Get all 4 pegs around the board and into Finish. First player to get all 4 pegs to Finish wins!"
            },
            {
                name: "Uno",
                icon: "1Ô∏è‚É£",
                color: "#e63946",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/uno",
                downloadInstructions: "https://service.mattel.com/instruction_sheets/42001pr.pdf",
                rules: "Match the color or number of the top discard pile card. Special cards: Skip, Reverse, Draw Two, Wild, Wild Draw Four. When you play your second-to-last card, yell 'UNO!' or draw 2 cards as penalty. First to play all cards wins the round. Score points from opponents' remaining cards. First to 500 points wins!"
            },
            {
                name: "Unstable Unicorns",
                icon: "ü¶Ñ",
                color: "#ff69b4",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://unstablegames.com/pages/unstable-unicorns-game-rules",
                downloadInstructions: "https://unstablegames.com/pages/unstable-unicorns-game-rules",
                rules: "Build a unicorn army! Start with a baby unicorn. Draw a card, play a card. Bring unicorns to your stable, use magic cards to help yourself or destroy opponents' unicorns, and add upgrades/downgrades. Watch for Neigh cards that can stop actions! First to 7 unicorns in their stable wins!"
            },
            {
                name: "Whonu",
                icon: "üé≠",
                color: "#8338ec",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.boardgamecapital.com/game_rules/whonu.pdf",
                downloadInstructions: "https://www.boardgamecapital.com/game_rules/whonu.pdf",
                rules: "Guess what others like! One player is the Selector. They choose 6 photo cards they like and rank them 1-6. Other players predict the Selector's rankings. Score points for correct guesses (6 points for exact match, decreasing). Selector also scores for each correct guess. Take turns being Selector. Most points wins!"
            },
            {
                name: "Yahtzee",
                icon: "üé≤",
                color: "#d62828",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/yahtzee",
                downloadInstructions: "https://www.dicegamedepot.com/yahtzee-score-sheets/",
                specialScorecard: "yahtzee",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/yahtzee/",
                rules: "Roll 5 dice up to 3 times per turn. Keep dice you want and re-roll the rest. Fill in scorecard categories: Upper (1s through 6s), Lower (3/4 of a Kind, Full House, Straights, Yahtzee=all 5 same). Score 63+ in Upper Section for 35 point bonus. Each category used once. Highest total wins!"
            },
            {
                name: "Farkle",
                icon: "üé≤",
                color: "#9b59b6",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.dicegamedepot.com/farkle-rules/",
                downloadInstructions: "https://www.dicegamedepot.com/farkle-rules/",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/farkle/",
                rules: "Roll 6 dice and score combinations: 1s (100 pts), 5s (50 pts), three-of-a-kind, straights, etc. Set aside scoring dice and re-roll the rest to increase your score. Risk it all or bank your points! Roll all non-scoring dice and you FARKLE - losing all points for that turn. First to 10,000 wins!"
            },
            {
                name: "Left Center Right",
                icon: "üé≤",
                color: "#27ae60",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/left-center-right",
                downloadInstructions: "https://www.officialgamerules.org/left-center-right",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/left-center-right/",
                rules: "Start with 3 chips each. Roll special dice showing L, C, R, or dots. L = pass chip left, C = put chip in center pot, R = pass chip right, dots = keep your chips. Roll as many dice as you have chips (max 3). Last player with chips wins the center pot! Simple, fast, and fun!"
            },
            {
                name: "Bunco",
                icon: "üé≤",
                color: "#e74c3c",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/bunco",
                downloadInstructions: "https://www.officialgamerules.org/bunco",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/bunco/",
                specialScorecard: "bunco",
                rules: "A social dice game for 12 players in teams of 2. Roll 3 dice trying to match the round number (Round 1 = roll 1s, Round 2 = roll 2s, etc.). Each match scores 1 point. Roll all 3 matching = BUNCO (21 points)! First team to 21 points wins the round. Play 6 rounds. Most wins overall wins the game!"
            },
            {
                name: "Qwixx",
                icon: "üé≤",
                color: "#16a085",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.boardgamegeek.com/boardgame/131260/qwixx",
                downloadInstructions: "https://www.boardgamegeek.com/boardgame/131260/qwixx",
                dicegameLink: true,
                dicegameDepotUrl: "https://www.dicegamedepot.com/qwixx/",
                rules: "Roll 6 dice (2 white, 4 colored). Active player uses white dice sum OR one white + one color. Mark numbers left to right in colored rows. Once marked, can't go backward! Other players can use white dice too. Lock a row by marking the rightmost number. Game ends when 2 rows are locked or a player has 4 penalties. Most points wins!"
            },
            {
                name: "Flip 7",
                icon: "üÉè",
                color: "#f39c12",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://boardgamegeek.com/boardgame/391923/flip-7",
                downloadInstructions: "https://boardgamegeek.com/boardgame/391923/flip-7",
                rules: "A fast Blackjack-style game! Draw cards trying to get exactly 7 or close to it without going over. Special cards have abilities: steal points, force draws, reverse direction, and more! Decide to stick or risk another card. Go over 7 and you bust! First to 77 points wins. Simple rules but addictively fun!"
            },
            {
                name: "Catan",
                icon: "üèùÔ∏è",
                color: "#d35400",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.catan.com/understand-catan/game-rules",
                downloadInstructions: "https://www.catan.com/sites/default/files/2021-06/catan_base_rules_2020_200707.pdf",
                rules: "Build settlements and cities on the island of Catan! Roll dice to collect resources (wheat, wood, brick, sheep, ore). Trade with other players. Use resources to build roads, settlements, and cities. Earn victory points for buildings and achievements. First to 10 victory points wins! Strategic trading and placement are key."
            },
            {
                name: "Apples to Apples",
                icon: "üçé",
                color: "#c0392b",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.officialgamerules.org/apples-to-apples",
                downloadInstructions: "https://service.mattel.com/instruction_sheets/N1384-0920.pdf",
                rules: "A hilarious comparison game! One player is the judge and plays a green adjective card. Other players choose their funniest or best-matching red noun card from their hand. Judge picks the winner! Winner keeps the green card. First to earn a set number of green cards (usually 4-7) wins. It's all about knowing the judge!"
            },
            {
                name: "King of Tokyo",
                icon: "üëæ",
                color: "#8e44ad",
                hasScorecard: true,
                hasTimer: false,
                hasCalculator: true,
                timerDefault: 3,
                instructions: "https://www.iello.fr/en/fiche/king-of-tokyo",
                downloadInstructions: "https://cdn.1j1ju.com/medias/5b/42/95-king-of-tokyo-rulebook.pdf",
                rules: "Be a giant monster battling for control of Tokyo! Roll 6 dice up to 3 times. Dice show: numbers (victory points), energy (buy cards), claws (attack), and hearts (heal). Control Tokyo to earn points but take all attacks! Leave Tokyo to heal. First to 20 points OR last monster standing wins!"
            },
            {
                name: "Splendor",
                icon: "üíé",
                color: "#34495e",
                hasScorecard: false,
                hasTimer: false,
                hasCalculator: false,
                timerDefault: 3,
                instructions: "https://www.spacecowboys.fr/splendor",
                downloadInstructions: "https://cdn.1j1ju.com/medias/80/95/ff-splendor-rulebook.pdf",
                rules: "Become a Renaissance merchant! Collect gem tokens to purchase development cards. Cards provide permanent gem bonuses and prestige points. Build an engine of cards to buy more valuable cards. Attract nobles for bonus points. First player to 15 prestige points triggers the final round. Most points wins!"
            }
        ];

        // Sort games alphabetically
        games.sort((a, b) => a.name.localeCompare(b.name));

        // State management
        let currentFilter = 'all';
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
        let collection = JSON.parse(localStorage.getItem('collection') || '[]');
        let customGames = JSON.parse(localStorage.getItem('customGames') || '[]');

        // Combine default and custom games
        let allGames = [...games, ...customGames];

        // Initialize
        function init() {
            renderGames();
            setupEventListeners();
        }

        function setupEventListeners() {
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    renderGames();
                });
            });

            // Search
            document.getElementById('searchBox').addEventListener('input', (e) => {
                renderGames(e.target.value);
            });
        }

        function renderGames(searchTerm = '') {
            const grid = document.getElementById('gamesGrid');
            let filteredGames = allGames;

            // Apply filter
            if (currentFilter === 'favorites') {
                filteredGames = allGames.filter(g => favorites.includes(g.name));
            } else if (currentFilter === 'collection') {
                filteredGames = allGames.filter(g => collection.includes(g.name));
            }

            // Apply search
            if (searchTerm) {
                filteredGames = filteredGames.filter(g => 
                    g.name.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }

            grid.innerHTML = filteredGames.map(game => `
                <div class="game-card" style="animation-delay: ${Math.random() * 0.3}s;">
                    <div class="game-icon" style="background: ${game.color};">
                        ${game.icon}
                    </div>
                    <h3 class="game-title">${game.name}</h3>
                    <div class="game-actions">
                        <button class="action-btn btn-primary" onclick="openGame('${game.name}')">
                            üéÆ Play
                        </button>
                        <a href="${game.downloadInstructions}" target="_blank" class="action-btn btn-secondary" style="text-decoration: none; text-align: center;">
                            Download Rules
                        </a>
                        <a href="${game.instructions}" target="_blank" class="action-btn btn-secondary" style="text-decoration: none; text-align: center;">
                            üìñ Online
                        </a>
                    </div>
                    ${game.dicegameLink ? `
                        <a href="${game.dicegameDepotUrl || 'https://dicegamedepot.com'}" target="_blank" class="action-btn btn-secondary" style="text-decoration: none; text-align: center; width: 100%; margin-top: 0.5rem; display: block;">
                            üé≤ Dice Depot
                        </a>
                    ` : ''}
                    <div class="game-features">
                        ${game.hasScorecard ? '<span class="feature-badge">üìä Scorecard</span>' : ''}
                        ${game.hasTimer ? '<span class="feature-badge">‚è±Ô∏è Timer</span>' : ''}
                        ${game.hasCalculator ? '<span class="feature-badge">üî¢ Calculator</span>' : ''}
                    </div>
                    <div class="collection-btns">
                        <button class="collection-btn ${favorites.includes(game.name) ? 'active' : ''}" 
                                onclick="toggleFavorite('${game.name}')" title="Favorite">
                            ${favorites.includes(game.name) ? '‚≠ê' : '‚òÜ'}
                        </button>
                        <button class="collection-btn ${collection.includes(game.name) ? 'active' : ''}" 
                                onclick="toggleCollection('${game.name}')" title="In Collection">
                            ${collection.includes(game.name) ? 'üìö' : 'üìñ'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function toggleFavorite(gameName) {
            if (favorites.includes(gameName)) {
                favorites = favorites.filter(f => f !== gameName);
            } else {
                favorites.push(gameName);
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            renderGames();
        }

        function toggleCollection(gameName) {
            if (collection.includes(gameName)) {
                collection = collection.filter(c => c !== gameName);
            } else {
                collection.push(gameName);
            }
            localStorage.setItem('collection', JSON.stringify(collection));
            renderGames();
        }

        function openGame(gameName) {
            const game = allGames.find(g => g.name === gameName);
            const modal = document.getElementById('gameModal');
            const content = document.getElementById('modalContent');
            
            let html = `
                <h2 class="modal-title">${game.icon} ${game.name}</h2>
                
                <div class="scorecard" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(247, 184, 1, 0.1)); border-left: 4px solid ${game.color};">
                    <h3 style="color: ${game.color}; margin-bottom: 1rem;">üìñ How to Play</h3>
                    <p style="line-height: 1.6; color: #2d3748;">${game.rules || 'Rules not available. Check the instruction links below for detailed gameplay.'}</p>
                </div>
            `;

            // Scorecard
            if (game.hasScorecard) {
                if (game.specialScorecard === 'yahtzee') {
                    html += renderYahtzeeScorecard(game);
                } else if (game.specialScorecard === 'phase10') {
                    html += renderPhase10Scorecard(game);
                } else if (game.specialScorecard === 'scattergories') {
                    html += renderScattergoriesScorecard(game);
                } else if (game.specialScorecard === 'clue') {
                    html += renderClueScorecard(game);
                } else if (game.specialScorecard === 'bunco') {
                    html += renderBuncoScorecard(game);
                } else {
                    html += renderGenericScorecard(game);
                }
            }

            // Timer
            if (game.hasTimer) {
                html += renderTimer(game);
            }

            // Calculator
            if (game.hasCalculator) {
                html += renderCalculator();
            }

            content.innerHTML = html;
            modal.classList.add('active');
        }

        function renderGenericScorecard(game) {
            const savedData = JSON.parse(localStorage.getItem(`scorecard_${game.name}`) || '{"players": []}');
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üìä Scorecard</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #10b981; color: white;" onclick="resetScores('${game.name}')">Reset Scores</button>
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <button class="score-btn" style="background: #3b82f6; color: white;" onclick="downloadScorecard('${game.name}')">üì• Download</button>
                        </div>
                    </div>
                    <div id="players_${game.name}">
                        ${savedData.players.map((player, idx) => `
                            <div class="player-input">
                                <input type="text" class="score-input" placeholder="Player Name" value="${player.name}" onchange="saveScorecard('${game.name}')">
                                <input type="number" class="score-input" placeholder="Score" value="${player.score || ''}" onchange="saveScorecard('${game.name}')">
                            </div>
                        `).join('')}
                    </div>
                    <button class="add-player-btn" onclick="addPlayer('${game.name}')">+ Add Player</button>
                </div>
            `;
        }

        function renderYahtzeeScorecard(game) {
            const savedData = JSON.parse(localStorage.getItem(`scorecard_${game.name}`) || '{"players": ["Player 1", "Player 2", "Player 3", "Player 4"]}');
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üé≤ Yahtzee Scorecard</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #10b981; color: white;" onclick="resetScores('${game.name}')">Reset Scores</button>
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <a href="https://www.hasbro.com/common/instruct/Yahtzee.pdf" target="_blank" class="score-btn" style="background: #3b82f6; color: white; text-decoration: none;">üì• Download</a>
                        </div>
                    </div>
                    <div class="yahtzee-scorecard" id="yahtzee_${game.name}">
                        ${renderYahtzeeSheet(savedData.players)}
                    </div>
                </div>
            `;
        }

        function renderYahtzeeSheet(players) {
            const categories = {
                upper: ['Ones', 'Twos', 'Threes', 'Fours', 'Fives', 'Sixes'],
                lower: ['3 of a Kind', '4 of a Kind', 'Full House', 'Small Straight', 'Large Straight', 'Yahtzee', 'Chance']
            };

            return `
                <div class="yahtzee-section">
                    <div class="yahtzee-row">
                        <div class="yahtzee-label">Player Names</div>
                        ${players.map((p, idx) => `
                            <input type="text" class="score-input" value="${p}" onchange="updateYahtzeePlayerName(${idx}, this.value)">
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    <div class="section-title">Upper Section</div>
                    ${categories.upper.map(cat => `
                        <div class="yahtzee-row">
                            <div class="yahtzee-label">${cat}</div>
                            ${players.map((p, idx) => `
                                <input type="number" class="score-input" id="y_${cat}_${idx}" onchange="calculateYahtzeeTotal()">
                            `).join('')}
                        </div>
                    `).join('')}
                    <div class="yahtzee-row total-row">
                        <div class="yahtzee-label">Upper Total</div>
                        ${players.map((p, idx) => `
                            <div id="upperTotal_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                    <div class="yahtzee-row total-row">
                        <div class="yahtzee-label">Bonus (35+)</div>
                        ${players.map((p, idx) => `
                            <div id="bonus_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    <div class="section-title">Lower Section</div>
                    ${categories.lower.map(cat => `
                        <div class="yahtzee-row">
                            <div class="yahtzee-label">${cat}</div>
                            ${players.map((p, idx) => `
                                <input type="number" class="score-input" id="y_${cat.replace(/ /g, '_')}_${idx}" onchange="calculateYahtzeeTotal()">
                            `).join('')}
                        </div>
                    `).join('')}
                    <div class="yahtzee-row total-row">
                        <div class="yahtzee-label">Lower Total</div>
                        ${players.map((p, idx) => `
                            <div id="lowerTotal_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    <div class="yahtzee-row total-row" style="background: linear-gradient(135deg, var(--primary), var(--accent)); color: white;">
                        <div class="yahtzee-label" style="color: white;">GRAND TOTAL</div>
                        ${players.map((p, idx) => `
                            <div id="grandTotal_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderPhase10Scorecard(game) {
            const savedData = JSON.parse(localStorage.getItem(`scorecard_${game.name}`) || '{"players": ["Player 1", "Player 2", "Player 3", "Player 4"]}');
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üîü Phase 10 Scorecard</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #10b981; color: white;" onclick="resetScores('${game.name}')">Reset Scores</button>
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <a href="https://service.mattel.com/instruction_sheets/42003pr.pdf" target="_blank" class="score-btn" style="background: #3b82f6; color: white; text-decoration: none;">üì• Download</a>
                        </div>
                    </div>
                    <div class="yahtzee-scorecard" id="phase10_${game.name}">
                        ${renderPhase10Sheet(savedData.players)}
                    </div>
                </div>
            `;
        }

        function renderPhase10Sheet(players) {
            const phases = Array.from({length: 10}, (_, i) => `Phase ${i + 1}`);

            return `
                <div class="yahtzee-section">
                    <div class="yahtzee-row">
                        <div class="yahtzee-label">Player Names</div>
                        ${players.map((p, idx) => `
                            <input type="text" class="score-input" value="${p}" onchange="updatePhase10PlayerName(${idx}, this.value)">
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    ${phases.map((phase, phaseIdx) => `
                        <div class="yahtzee-row">
                            <div class="yahtzee-label">${phase}</div>
                            ${players.map((p, idx) => `
                                <input type="number" class="score-input" id="p10_${phaseIdx}_${idx}" onchange="calculatePhase10Total()">
                            `).join('')}
                        </div>
                    `).join('')}
                    <div class="yahtzee-row total-row" style="background: linear-gradient(135deg, var(--primary), var(--accent)); color: white;">
                        <div class="yahtzee-label" style="color: white;">TOTAL</div>
                        ${players.map((p, idx) => `
                            <div id="p10Total_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderScattergoriesScorecard(game) {
            const savedData = JSON.parse(localStorage.getItem(`scorecard_${game.name}`) || '{"players": ["Player 1", "Player 2", "Player 3", "Player 4"]}');
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üìù Scattergories Scorecard</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #10b981; color: white;" onclick="resetScores('${game.name}')">Reset Scores</button>
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <a href="https://www.papertraildesign.com/printable-scattergories-game/" target="_blank" class="score-btn" style="background: #3b82f6; color: white; text-decoration: none;">üì• Download</a>
                        </div>
                    </div>
                    <div class="yahtzee-scorecard" id="scattergories_${game.name}">
                        ${renderScattergoriesSheet(savedData.players)}
                    </div>
                </div>
            `;
        }

        function renderScattergoriesSheet(players) {
            const rounds = Array.from({length: 3}, (_, i) => `Round ${i + 1}`);

            return `
                <div class="yahtzee-section">
                    <div class="yahtzee-row">
                        <div class="yahtzee-label">Player Names</div>
                        ${players.map((p, idx) => `
                            <input type="text" class="score-input" value="${p}" onchange="updateScattergoriesPlayerName(${idx}, this.value)">
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    ${rounds.map((round, roundIdx) => `
                        <div class="yahtzee-row">
                            <div class="yahtzee-label">${round}</div>
                            ${players.map((p, idx) => `
                                <input type="number" class="score-input" id="sc_${roundIdx}_${idx}" onchange="calculateScattergoriesTotal()">
                            `).join('')}
                        </div>
                    `).join('')}
                    <div class="yahtzee-row total-row" style="background: linear-gradient(135deg, var(--primary), var(--accent)); color: white;">
                        <div class="yahtzee-label" style="color: white;">TOTAL</div>
                        ${players.map((p, idx) => `
                            <div id="scTotal_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderClueScorecard(game) {
            const suspects = ['Colonel Mustard', 'Miss Scarlet', 'Professor Plum', 'Mr. Green', 'Mrs. White', 'Mrs. Peacock'];
            const weapons = ['Candlestick', 'Knife', 'Lead Pipe', 'Revolver', 'Rope', 'Wrench'];
            const rooms = ['Kitchen', 'Ballroom', 'Conservatory', 'Dining Room', 'Billiard Room', 'Library', 'Lounge', 'Hall', 'Study'];
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üîç Clue Detective Sheet</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <a href="https://www.printablepaper.net/preview/Clue_Scoresheet" target="_blank" class="score-btn" style="background: #3b82f6; color: white; text-decoration: none;">üì• Download</a>
                        </div>
                    </div>
                    <div class="yahtzee-scorecard" id="clue_${game.name}">
                        <div class="yahtzee-section">
                            <div class="section-title">Suspects</div>
                            ${suspects.map(suspect => `
                                <div class="yahtzee-row clue-row">
                                    <div class="yahtzee-label">${suspect}</div>
                                    <button class="score-input" id="clue_${suspect.replace(/ /g, '_')}" 
                                            onclick="toggleClueItem('clue_${suspect.replace(/ /g, '_')}')"
                                            style="cursor: pointer; background: white; border: 2px solid #e5e7eb; font-size: 1.5rem;">
                                        ‚òê
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <div class="yahtzee-section">
                            <div class="section-title">Weapons</div>
                            ${weapons.map(weapon => `
                                <div class="yahtzee-row clue-row">
                                    <div class="yahtzee-label">${weapon}</div>
                                    <button class="score-input" id="clue_${weapon.replace(/ /g, '_')}" 
                                            onclick="toggleClueItem('clue_${weapon.replace(/ /g, '_')}')"
                                            style="cursor: pointer; background: white; border: 2px solid #e5e7eb; font-size: 1.5rem;">
                                        ‚òê
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <div class="yahtzee-section">
                            <div class="section-title">Rooms</div>
                            ${rooms.map(room => `
                                <div class="yahtzee-row clue-row">
                                    <div class="yahtzee-label">${room}</div>
                                    <button class="score-input" id="clue_${room.replace(/ /g, '_')}" 
                                            onclick="toggleClueItem('clue_${room.replace(/ /g, '_')}')"
                                            style="cursor: pointer; background: white; border: 2px solid #e5e7eb; font-size: 1.5rem;">
                                        ‚òê
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderBuncoScorecard(game) {
            const savedData = JSON.parse(localStorage.getItem(`scorecard_${game.name}`) || '{"teams": ["Team 1", "Team 2", "Team 3", "Team 4", "Team 5", "Team 6"]}');
            
            return `
                <div class="scorecard">
                    <div class="scorecard-header">
                        <h3>üé≤ Bunco Scorecard</h3>
                        <div class="scorecard-actions">
                            <button class="score-btn" style="background: #10b981; color: white;" onclick="resetScores('${game.name}')">Reset Scores</button>
                            <button class="score-btn" style="background: #ef4444; color: white;" onclick="resetAll('${game.name}')">Reset All</button>
                            <a href="https://www.officialgamerules.org/bunco" target="_blank" class="score-btn" style="background: #3b82f6; color: white; text-decoration: none;">üì• Download</a>
                        </div>
                    </div>
                    <div class="yahtzee-scorecard" id="bunco_${game.name}">
                        ${renderBuncoSheet(savedData.teams)}
                    </div>
                </div>
            `;
        }

        function renderBuncoSheet(teams) {
            const rounds = Array.from({length: 6}, (_, i) => `Round ${i + 1}`);

            return `
                <div class="yahtzee-section">
                    <div class="yahtzee-row">
                        <div class="yahtzee-label">Team Names</div>
                        ${teams.map((t, idx) => `
                            <input type="text" class="score-input" value="${t}" onchange="updateBuncoTeamName(${idx}, this.value)">
                        `).join('')}
                    </div>
                </div>
                <div class="yahtzee-section">
                    ${rounds.map((round, roundIdx) => `
                        <div class="yahtzee-row">
                            <div class="yahtzee-label">${round}</div>
                            ${teams.map((t, idx) => `
                                <select class="score-input" id="bunco_${roundIdx}_${idx}" onchange="calculateBuncoTotal()">
                                    <option value="">-</option>
                                    <option value="W">W</option>
                                    <option value="L">L</option>
                                </select>
                            `).join('')}
                        </div>
                    `).join('')}
                    <div class="yahtzee-row total-row" style="background: linear-gradient(135deg, var(--primary), var(--accent)); color: white;">
                        <div class="yahtzee-label" style="color: white;">WINS</div>
                        ${teams.map((t, idx) => `
                            <div id="buncoTotal_${idx}" class="score-input" style="background: white; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; color: #1a1a2e;">0</div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderTimer(game) {
            return `
                <div class="scorecard" style="margin-top: 1rem;">
                    <h3>‚è±Ô∏è Game Timer</h3>
                    <div class="timer-display" id="timer_display_${game.name}">
                        <span id="timer_${game.name}">${String(game.timerDefault).padStart(2, '0')}:00</span>
                    </div>
                    <div class="timer-controls">
                        <button class="score-btn" style="background: #10b981; color: white;" onclick="startTimer('${game.name}', ${game.timerDefault})">‚ñ∂ Start</button>
                        <button class="score-btn" style="background: #ef4444; color: white;" onclick="stopTimer('${game.name}')">‚è∏ Pause</button>
                        <button class="score-btn" style="background: #3b82f6; color: white;" onclick="resetTimer('${game.name}', ${game.timerDefault})">‚Üª Reset</button>
                        <button class="score-btn" style="background: #f59e0b; color: white;" onclick="adjustTimer('${game.name}', 1)">+ 1 min</button>
                        <button class="score-btn" style="background: #8b5cf6; color: white;" onclick="adjustTimer('${game.name}', -1)">- 1 min</button>
                    </div>
                </div>
            `;
        }

        function renderCalculator() {
            return `
                <div class="calculator" style="margin-top: 1rem;">
                    <h3>üî¢ Score Calculator</h3>
                    <div class="calc-display" id="calc_display">0</div>
                    <div class="calc-buttons">
                        <button class="calc-btn" onclick="calcInput('7')">7</button>
                        <button class="calc-btn" onclick="calcInput('8')">8</button>
                        <button class="calc-btn" onclick="calcInput('9')">9</button>
                        <button class="calc-btn operator" onclick="calcInput('/')">√∑</button>
                        <button class="calc-btn" onclick="calcInput('4')">4</button>
                        <button class="calc-btn" onclick="calcInput('5')">5</button>
                        <button class="calc-btn" onclick="calcInput('6')">6</button>
                        <button class="calc-btn operator" onclick="calcInput('*')">√ó</button>
                        <button class="calc-btn" onclick="calcInput('1')">1</button>
                        <button class="calc-btn" onclick="calcInput('2')">2</button>
                        <button class="calc-btn" onclick="calcInput('3')">3</button>
                        <button class="calc-btn operator" onclick="calcInput('-')">‚àí</button>
                        <button class="calc-btn" onclick="calcInput('0')">0</button>
                        <button class="calc-btn" onclick="calcClear()">C</button>
                        <button class="calc-btn equals" onclick="calcEquals()">=</button>
                        <button class="calc-btn operator" onclick="calcInput('+')">+</button>
                    </div>
                </div>
            `;
        }

        // Timer functions
        let timerIntervals = {};
        let timerSeconds = {};

        function startTimer(gameName, defaultMinutes) {
            if (timerIntervals[gameName]) return;
            
            if (!timerSeconds[gameName]) {
                timerSeconds[gameName] = defaultMinutes * 60;
            }
            
            timerIntervals[gameName] = setInterval(() => {
                if (timerSeconds[gameName] > 0) {
                    timerSeconds[gameName]--;
                    updateTimerDisplay(gameName);
                } else {
                    stopTimer(gameName);
                    alert(`Time's up for ${gameName}!`);
                }
            }, 1000);
        }

        function stopTimer(gameName) {
            if (timerIntervals[gameName]) {
                clearInterval(timerIntervals[gameName]);
                timerIntervals[gameName] = null;
            }
        }

        function resetTimer(gameName, defaultMinutes) {
            stopTimer(gameName);
            timerSeconds[gameName] = defaultMinutes * 60;
            updateTimerDisplay(gameName);
        }

        function adjustTimer(gameName, minutes) {
            timerSeconds[gameName] = Math.max(0, (timerSeconds[gameName] || 0) + (minutes * 60));
            updateTimerDisplay(gameName);
        }

        function updateTimerDisplay(gameName) {
            const minutes = Math.floor(timerSeconds[gameName] / 60);
            const seconds = timerSeconds[gameName] % 60;
            const display = document.getElementById(`timer_${gameName}`);
            if (display) {
                display.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        // Calculator functions
        let calcValue = '';
        let calcOperator = '';
        let calcPrevious = '';

        function calcInput(value) {
            calcValue += value;
            document.getElementById('calc_display').textContent = calcValue || '0';
        }

        function calcClear() {
            calcValue = '';
            calcOperator = '';
            calcPrevious = '';
            document.getElementById('calc_display').textContent = '0';
        }

        function calcEquals() {
            try {
                const result = eval(calcValue);
                document.getElementById('calc_display').textContent = result;
                calcValue = String(result);
            } catch (e) {
                document.getElementById('calc_display').textContent = 'Error';
                calcValue = '';
            }
        }

        // Scorecard functions
        function addPlayer(gameName) {
            const container = document.getElementById(`players_${gameName}`);
            const newPlayer = document.createElement('div');
            newPlayer.className = 'player-input';
            newPlayer.innerHTML = `
                <input type="text" class="score-input" placeholder="Player Name" onchange="saveScorecard('${gameName}')">
                <input type="number" class="score-input" placeholder="Score" onchange="saveScorecard('${gameName}')">
            `;
            container.appendChild(newPlayer);
            saveScorecard(gameName);
        }

        function saveScorecard(gameName) {
            const container = document.getElementById(`players_${gameName}`);
            const inputs = container.querySelectorAll('.player-input');
            const players = Array.from(inputs).map(input => ({
                name: input.querySelector('input[type="text"]').value,
                score: input.querySelector('input[type="number"]').value
            }));
            localStorage.setItem(`scorecard_${gameName}`, JSON.stringify({players}));
        }

        function resetScores(gameName) {
            const container = document.getElementById(`players_${gameName}`);
            if (container) {
                const inputs = container.querySelectorAll('input[type="number"]');
                inputs.forEach(input => input.value = '');
                saveScorecard(gameName);
            }
            
            // Reset Yahtzee scores
            document.querySelectorAll('[id^="y_"]').forEach(input => input.value = '');
            calculateYahtzeeTotal();
            
            // Reset Phase 10 scores
            document.querySelectorAll('[id^="p10_"]').forEach(input => input.value = '');
            calculatePhase10Total();
            
            // Reset Scattergories scores
            document.querySelectorAll('[id^="sc_"]').forEach(input => input.value = '');
            calculateScattergoriesTotal();
        }

        function resetAll(gameName) {
            localStorage.removeItem(`scorecard_${gameName}`);
            openGame(gameName);
        }

        function downloadScorecard(gameName) {
            const container = document.getElementById(`players_${gameName}`);
            const inputs = container.querySelectorAll('.player-input');
            let csv = 'Player Name,Score\n';
            inputs.forEach(input => {
                const name = input.querySelector('input[type="text"]').value;
                const score = input.querySelector('input[type="number"]').value;
                csv += `${name},${score}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${gameName}_scorecard.csv`;
            a.click();
        }

        // Yahtzee calculation
        function calculateYahtzeeTotal() {
            const playerCount = 4;
            const upperCategories = ['Ones', 'Twos', 'Threes', 'Fours', 'Fives', 'Sixes'];
            const lowerCategories = ['3_of_a_Kind', '4_of_a_Kind', 'Full_House', 'Small_Straight', 'Large_Straight', 'Yahtzee', 'Chance'];
            
            for (let i = 0; i < playerCount; i++) {
                let upperTotal = 0;
                upperCategories.forEach(cat => {
                    const val = parseInt(document.getElementById(`y_${cat}_${i}`)?.value || 0);
                    upperTotal += val;
                });
                
                const upperTotalEl = document.getElementById(`upperTotal_${i}`);
                if (upperTotalEl) upperTotalEl.textContent = upperTotal;
                
                const bonus = upperTotal >= 63 ? 35 : 0;
                const bonusEl = document.getElementById(`bonus_${i}`);
                if (bonusEl) bonusEl.textContent = bonus;
                
                let lowerTotal = 0;
                lowerCategories.forEach(cat => {
                    const val = parseInt(document.getElementById(`y_${cat}_${i}`)?.value || 0);
                    lowerTotal += val;
                });
                
                const lowerTotalEl = document.getElementById(`lowerTotal_${i}`);
                if (lowerTotalEl) lowerTotalEl.textContent = lowerTotal;
                
                const grandTotal = upperTotal + bonus + lowerTotal;
                const grandTotalEl = document.getElementById(`grandTotal_${i}`);
                if (grandTotalEl) grandTotalEl.textContent = grandTotal;
            }
        }

        function updateYahtzeePlayerName(idx, value) {
            // Player names are updated automatically through input binding
        }

        // Phase 10 calculation
        function calculatePhase10Total() {
            const playerCount = 4;
            const phaseCount = 10;
            
            for (let i = 0; i < playerCount; i++) {
                let total = 0;
                for (let p = 0; p < phaseCount; p++) {
                    const val = parseInt(document.getElementById(`p10_${p}_${i}`)?.value || 0);
                    total += val;
                }
                
                const totalEl = document.getElementById(`p10Total_${i}`);
                if (totalEl) totalEl.textContent = total;
            }
        }

        function updatePhase10PlayerName(idx, value) {
            // Player names are updated automatically through input binding
        }

        // Scattergories calculation
        function calculateScattergoriesTotal() {
            const playerCount = 4;
            const roundCount = 3;
            
            for (let i = 0; i < playerCount; i++) {
                let total = 0;
                for (let r = 0; r < roundCount; r++) {
                    const val = parseInt(document.getElementById(`sc_${r}_${i}`)?.value || 0);
                    total += val;
                }
                
                const totalEl = document.getElementById(`scTotal_${i}`);
                if (totalEl) totalEl.textContent = total;
            }
        }

        function updateScattergoriesPlayerName(idx, value) {
            // Player names are updated automatically through input binding
        }

        function updateCluePlayerName(idx, value) {
            // Player names are updated automatically through input binding
        }

        function toggleClueItem(itemId) {
            const item = document.getElementById(itemId);
            if (item) {
                if (item.textContent === '‚òê') {
                    item.textContent = '‚òë';
                    item.style.background = 'rgba(16, 185, 129, 0.1)';
                } else {
                    item.textContent = '‚òê';
                    item.style.background = 'white';
                }
            }
        }

        function updateBuncoTeamName(idx, value) {
            // Team names are updated automatically through input binding
        }

        function calculateBuncoTotal() {
            const teamCount = 6;
            const roundCount = 6;
            
            for (let i = 0; i < teamCount; i++) {
                let wins = 0;
                for (let r = 0; r < roundCount; r++) {
                    const val = document.getElementById(`bunco_${r}_${i}`)?.value || '';
                    if (val === 'W') wins++;
                }
                
                const totalEl = document.getElementById(`buncoTotal_${i}`);
                if (totalEl) totalEl.textContent = wins;
            }
        }

        // Modal functions
        function closeModal() {
            document.getElementById('gameModal').classList.remove('active');
            // Stop all timers when closing
            Object.keys(timerIntervals).forEach(key => stopTimer(key));
        }

        function openAddGameModal() {
            document.getElementById('addGameModal').classList.add('active');
        }

        function closeAddGameModal() {
            document.getElementById('addGameModal').classList.remove('active');
        }

        function addNewGame(event) {
            event.preventDefault();
            
            const newGame = {
                name: document.getElementById('newGameName').value,
                icon: document.getElementById('newGameIcon').value || 'üéÆ',
                color: document.getElementById('newGameColor').value,
                hasScorecard: document.getElementById('needsScorecard').checked,
                hasTimer: document.getElementById('needsTimer').checked,
                hasCalculator: document.getElementById('needsCalculator').checked,
                timerDefault: parseInt(document.getElementById('timerDefault').value) || 3,
                instructions: '#',
                downloadInstructions: '#'
            };
            
            customGames.push(newGame);
            localStorage.setItem('customGames', JSON.stringify(customGames));
            allGames = [...games, ...customGames];
            allGames.sort((a, b) => a.name.localeCompare(b.name));
            
            closeAddGameModal();
            renderGames();
            
            // Reset form
            document.getElementById('newGameName').value = '';
            document.getElementById('newGameIcon').value = '';
            document.getElementById('newGameColor').value = '#667eea';
            document.getElementById('needsScorecard').checked = false;
            document.getElementById('needsTimer').checked = false;
            document.getElementById('needsCalculator').checked = false;
            document.getElementById('timerDefault').value = '3';
        }

        // Close modals on background click
        document.getElementById('gameModal').addEventListener('click', (e) => {
            if (e.target.id === 'gameModal') closeModal();
        });

        document.getElementById('addGameModal').addEventListener('click', (e) => {
            if (e.target.id === 'addGameModal') closeAddGameModal();
        });

        // Initialize app
        init();
    </script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>